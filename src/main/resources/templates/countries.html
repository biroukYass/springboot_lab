<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Products</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    <link rel="stylesheet" href="webjars/bootstrap/3.3.5/css/bootstrap.min.css" media="screen"/>
    <script th:src="@{webjars/jquery/3.3.1/jquery.min.js}"></script>
    <script th:src="@{//https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js}">...</script>
</head>
<body>
<div th:replace="fragments/header :: header">...</div>
<div class="container">
    <!-- <div class="" id=""> -->
	    <div class="alert alert-success">
	        <strong>this is the list of all countries</strong>
	    </div>

		<table class="table table-striped table-hover">
			<thead>
		        <tr>
		            <th>Country ID</th>
		            <th>Country Name</th>
		            <th>Region Name</th>
		            <th>Locations</th>
		            <th>Action</th>
		        </tr>
		        </thead>
		        <tbody>
			<tr th:each="country : ${countries}">
	            <td th:text="${country.countryId}"></td>
	            <td th:text="${country.countryName}"></td>
	            <td th:text="${country.regionName}"></td>
	            <td>
	                <table>
	                    <tr th:each="location :${country.locations}">
	                        <td th:text="${location.streetAddress}"></td><td>&nbsp;&nbsp;</td>
	                        <td th:text="${location.postalCode}"></td><td>&nbsp;&nbsp;</td>
	                        <td th:text="${location.city}"></td>
	                    </tr>
	                </table>
	            </td>
	            <td><button type="button" class=" btn btn-default">Select</button></td>
	        </tr>
        </table>
        <form action="#" th:action="@{/query}" th:object="${request}" method="post">
        <p>Query: <input width="50%" type="text" name="sqlQuery" id="sqlQuery" /></p>
        <p><input type="submit" value="Submit" /> <input type="reset" value="Reset" /></p>
    </form>
        <form id="register">
			<input type="text" name="countryId" id="country_id"  value=""  placeholder="Country Id"> 
			<input type="text" name="countryId_old" id="country_id_old"  value=""  hidden="true"> 
			<input type="text" name="countryName" id="country_name" value="" placeholder="Country Name"> 
			<input type="text" name="regionName" id="region_name" value="" placeholder="Region Name"> 
			<input type="submit" name="valider" value="Modify"> 
		</form>
		<br><br><br><br>
    <!-- </div> -->
    <div th:replace="fragments/footer :: footer">...</div>
</div>

<script th:inline="javascript">
/*<![CDATA[*/
$(document).ready(function(){
			
                        $('.btn').on('click',function(){
                                $("#country_id").val($(this).closest('tr').find("td:eq(0)").text());
                                $("#country_id_old").val($(this).closest('tr').find("td:eq(0)").text());
                                $("#country_name").val($(this).closest('tr').find("td:eq(1)").text());
                                $("#region_name").val($(this).closest('tr').find("td:eq(2)").text());

                                });
                        $('#register').submit(function(e) {
                                    var form = $(this);
                                    $.ajax({
                                          type: 'POST',
                                          url: "/modifyCountry",
                                          data: form.serialize(),
                                          contentType: 'application/json',
                                          success: function(modRes)
                                           {
                                                alert(modRes);
                                           }
                                       });

                                    e.preventDefault(); // avoid to execute the actual submit of the form.
                                });

                        });
/*]]>*/
</script>
</body>
</html>